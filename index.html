<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=no">
  <title>QUARTERアンケート</title>
  
  <!-- HTTPS強制リダイレクト -->
  <script src="js/https-redirect.js"></script>
  
  <!-- セキュリティヘッダー -->
  <!-- CSPは<meta>タグで設定可能 -->
  <meta http-equiv="Content-Security-Policy" 
        content="default-src 'self'; 
                 script-src 'self' https://cdn.jsdelivr.net 'sha256-vvt4KWwuNr51XfE5m+hzeNEGhiOfZzG97ccfqGsPwvE='; 
                 style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; 
                 font-src 'self' https://fonts.gstatic.com;
                 img-src 'self' data:;
                 connect-src 'self' https://script.google.com https://script.googleusercontent.com;">
  
  <!-- 注意: 以下のヘッダーはHTTPレスポンスヘッダーでのみ有効です -->
  <!-- GitHub Pagesでは.htaccessやサーバー設定が使えないため、これらは効果がありません -->
  <!-- X-Content-Type-Options: nosniff -->
  <!-- X-Frame-Options: DENY -->
  <!-- X-XSS-Protection: 1; mode=block -->
  
  <!-- Google Fonts - 原版から復元 -->
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&family=Playfair+Display:wght@400;600&display=swap" rel="stylesheet">
  
  <!-- 既存 CSS -->
  <link rel="stylesheet" href="css/styles.css">
  <link rel="stylesheet" href="css/form-styles.css">
  <link rel="stylesheet" href="css/responsive.css">
  <link rel="stylesheet" href="css/layout-fix.css">
  <link rel="stylesheet" href="css/menu-styles.css">
  <link rel="stylesheet" href="css/accordion-style.css">

  <!-- i18next 本体 -->
  <script src="https://cdn.jsdelivr.net/npm/i18next@latest/dist/umd/i18next.min.js"></script>
  <!-- ブラウザ言語自動判定プラグイン -->
  <script src="https://cdn.jsdelivr.net/npm/i18next-browser-languagedetector@8.1.0/i18nextBrowserLanguageDetector.min.js"></script>

  <!-- ★ i18n 初期化 -->
  <script defer src="js/i18n.js"></script>

  <!-- セキュリティログ -->
  <script defer src="js/security-logger.js"></script>
  
  <!-- ユーティリティ関数 -->
  <script defer src="js/utils.js"></script>
  
  <!-- 既存 JS（順序自由） -->
  <script defer src="js/config.js"></script>
  <script defer src="js/navigation.js"></script>
  <script defer src="js/star-rating.js"></script>
  <script defer src="js/dynamic-services.js"></script>
  <script defer src="js/validation.js"></script>
  <script defer src="js/scroll-monitor.js"></script>
  <script defer src="js/main.js"></script>
  <script defer src="js/menu-formatter.js"></script>
</head>
<body>
  <div class="container">
    <!-- ★ ヘッダー（言語セレクタを右上に配置） -->
    <header class="site-header-alt">
      <div class="language-selector-top-right">
        <a href="#" class="lang-link" data-lang="ja">日本語</a>
        <span class="separator">|</span>
        <a href="#" class="lang-link" data-lang="en">English</a>
        <span class="separator">|</span>
        <a href="#" class="lang-link" data-lang="zh">中文</a>
      </div>
      
      <div class="logo-container">
        <img class="text-logo" src="./images/quarter-logo.png" alt="QUARTERロゴ" style="max-width: 200px; height: auto;">
      </div>
    </header>

    <!-- ナビゲーションバー - 原版の構造を復元 -->
    <div class="nav-container">
      <div class="progress-nav">
        <div class="nav-item active" data-section="store">
          <span class="nav-text" data-i18n="nav.store"></span>
          <div class="nav-indicator"></div>
        </div>
        <div class="nav-item" data-section="rating">
          <span class="nav-text" data-i18n="nav.rating"></span>
          <div class="nav-indicator"></div>
        </div>
        <div class="nav-item" data-section="info">
          <span class="nav-text" data-i18n="nav.info"></span>
          <div class="nav-indicator"></div>
        </div>
        <div class="nav-item" data-section="service">
          <span class="nav-text" data-i18n="nav.service"></span>
          <div class="nav-indicator"></div>
        </div>
        <div class="nav-item" data-section="feedback">
          <span class="nav-text" data-i18n="nav.feedback"></span>
          <div class="nav-indicator"></div>
        </div>
      </div>
    </div>

    <!-- アンケートフォーム -->
    <form id="surveyForm" novalidate>
      <!-- Q1. 店舗選択（必須） -->
      <div class="question required current" id="question1" data-section="store">
        <h3 data-i18n="q1.title"></h3>
        <div class="options">
          <input type="radio" id="quarter" name="store" value="QUARTER" required>
          <label for="quarter">QUARTER</label>
          
          <input type="radio" id="quarter-resort" name="store" value="QUARTER RESORT">
          <label for="quarter-resort">QUARTER RESORT</label>
          
          <input type="radio" id="quarter-seasons" name="store" value="QUARTER SEASONS">
          <label for="quarter-seasons">QUARTER SEASONS</label>
          
          <input type="radio" id="link" name="store" value="LINK">
          <label for="link">LINK</label>
          
          <input type="radio" id="il" name="store" value="iL">
          <label for="il">iL</label>
        </div>
        
        <div class="validation-message" id="store-validation">
          <span data-i18n="validation.store"></span>
        </div>
      </div>
      
      <!-- Q2. 総合評価（必須） -->
      <div class="question required" id="question2" data-section="rating">
        <h3 data-i18n="q2.title"></h3>
        
        <div class="star-rating-container">
          <div class="stars-row" data-stars-container>
            <span class="star" data-value="1">★</span>
            <span class="star" data-value="2">★</span>
            <span class="star" data-value="3">★</span>
            <span class="star" data-value="4">★</span>
            <span class="star" data-value="5">★</span>
          </div>
          
          <div class="rating-score" data-rating-score>
            <span data-i18n="rating.prefix"></span> <span data-score-value>0</span>/5
          </div>
        </div>
        
        <div class="star-rating-hidden">
          <input type="radio" id="star5" name="rating" value="5" required>
          <input type="radio" id="star4" name="rating" value="4">
          <input type="radio" id="star3" name="rating" value="3">
          <input type="radio" id="star2" name="rating" value="2">
          <input type="radio" id="star1" name="rating" value="1">
        </div>

        <div class="low-rating-warning" data-low-rating-warning style="display: none;">
          <span data-i18n="rating.lowWarning"></span>
        </div>

        <div class="validation-message" id="rating-validation">
          <span data-i18n="validation.rating"></span>
        </div>
      </div>
      
      <!-- 任意質問セクション - 復元 -->
      <div class="optional-questions">
        <p class="optional-note" data-i18n="optional.note"></p>
        
        <!-- Q3. お名前（任意） -->
        <div class="question" id="question3" data-section="info">
          <h3 data-i18n="q3.title"></h3>
          <textarea name="name" rows="1" data-i18n-placeholder="q3.placeholder"></textarea>
        </div>
        
        <!-- Q4. 来店タイプ（任意） -->
        <div class="question" id="question4" data-section="info">
          <h3 data-i18n="q4.title"></h3>
          <div class="options">
            <input type="radio" id="first-time" name="visitType" value="初めて（新規）">
            <label for="first-time" data-i18n="q4.firstTime"></label>
            
            <input type="radio" id="repeat" name="visitType" value="2回目以降（常連）">
            <label for="repeat" data-i18n="q4.repeat"></label>
          </div>
        </div>
        
        <!-- Q5. 性別（任意） -->
        <div class="question" id="question5" data-section="info">
          <h3 data-i18n="q5.title"></h3>
          <div class="options">
            <input type="radio" id="male" name="gender" value="男性">
            <label for="male" data-i18n="q5.male"></label>
            
            <input type="radio" id="female" name="gender" value="女性">
            <label for="female" data-i18n="q5.female"></label>
            
            <input type="radio" id="other" name="gender" value="その他">
            <label for="other" data-i18n="q5.other"></label>
          </div>
        </div>
        
        <!-- Q6. 年齢（任意） -->
        <div class="question" id="question6" data-section="info">
          <h3 data-i18n="q6.title"></h3>
          <div class="options">
            <input type="radio" id="age10s" name="age" value="10代">
            <label for="age10s" data-i18n="q6.age10s"></label>
            
            <input type="radio" id="age20s" name="age" value="20代">
            <label for="age20s" data-i18n="q6.age20s"></label>
            
            <input type="radio" id="age30s" name="age" value="30代">
            <label for="age30s" data-i18n="q6.age30s"></label>
            
            <input type="radio" id="age40s" name="age" value="40代">
            <label for="age40s" data-i18n="q6.age40s"></label>
            
            <input type="radio" id="age50s" name="age" value="50代">
            <label for="age50s" data-i18n="q6.age50s"></label>
            
            <input type="radio" id="age60plus" name="age" value="60代以上">
            <label for="age60plus" data-i18n="q6.age60plus"></label>
          </div>
        </div>
        
        <!-- Q7. 利用サービス（複数選択可） -->
        <div class="question" id="question7" data-section="service">
          <h3 data-i18n="q7.title"></h3>
            
          <!-- 通常店舗用のメニュー（デフォルト表示） -->
          <div class="options" id="standard-services">
            <input type="checkbox" id="cut" name="services" value="カット">
            <label for="cut" data-i18n="q7.cut"></label>
            
            <input type="checkbox" id="color" name="services" value="カラー">
            <label for="color" data-i18n="q7.color"></label>
            
            <input type="checkbox" id="perm" name="services" value="パーマ">
            <label for="perm" data-i18n="q7.perm"></label>
            
            <input type="checkbox" id="treatment" name="services" value="トリートメント">
            <label for="treatment" data-i18n="q7.treatment"></label>
            
            <input type="checkbox" id="headspa" name="services" value="ヘッドスパ">
            <label for="headspa" data-i18n="q7.headspa"></label>
            
            <input type="checkbox" id="other-service" name="services" value="その他">
            <label for="other-service" data-i18n="q7.other"></label>
          </div>
          
          <!-- iL店舗用のメニュー（初期状態では非表示） -->
          <div class="options" id="il-services" style="display: none;">
            <input type="checkbox" id="il-eyelash-ext" name="services" value="まつ毛エクステ">
            <label for="il-eyelash-ext" data-i18n="q7.il.eyelashExt"></label>
            
            <input type="checkbox" id="il-eyelash-perm" name="services" value="まつ毛パーマ">
            <label for="il-eyelash-perm" data-i18n="q7.il.eyelashPerm"></label>
            
            <input type="checkbox" id="il-wax" name="services" value="WAXメニュー">
            <label for="il-wax" data-i18n="q7.il.wax"></label>
            
            <input type="checkbox" id="il-other" name="services" value="その他メニュー">
            <label for="il-other" data-i18n="q7.il.other"></label>
          </div>
        </div>
          
        <!-- Q8. サービス満足度 - 星評価に変更 -->
        <div class="question" id="question8" data-section="service">
          <h3 data-i18n="q8.title"></h3>
          
          <div class="star-rating-container">
            <div class="stars-row" data-stars-container>
              <span class="star" data-value="1">★</span>
              <span class="star" data-value="2">★</span>
              <span class="star" data-value="3">★</span>
              <span class="star" data-value="4">★</span>
              <span class="star" data-value="5">★</span>
            </div>
            
            <div class="rating-score" data-rating-score>
              <span data-i18n="rating.prefix"></span> <span data-score-value>0</span>/5
            </div>
          </div>
          
          <div class="star-rating-hidden">
            <input type="radio" id="q8_star5" name="serviceSatisfaction" value="5">
            <input type="radio" id="q8_star4" name="serviceSatisfaction" value="4">
            <input type="radio" id="q8_star3" name="serviceSatisfaction" value="3">
            <input type="radio" id="q8_star2" name="serviceSatisfaction" value="2">
            <input type="radio" id="q8_star1" name="serviceSatisfaction" value="1">
          </div>

          <div class="low-rating-warning" data-low-rating-warning style="display: none;">
            <span data-i18n="rating.lowWarning"></span>
          </div>
        </div>
        
        <!-- Q9. スタッフ対応 - 星評価に変更 -->
        <div class="question" id="question9" data-section="service">
          <h3 data-i18n="q9.title"></h3>
          
          <div class="star-rating-container">
            <div class="stars-row" data-stars-container>
              <span class="star" data-value="1">★</span>
              <span class="star" data-value="2">★</span>
              <span class="star" data-value="3">★</span>
              <span class="star" data-value="4">★</span>
              <span class="star" data-value="5">★</span>
            </div>
            
            <div class="rating-score" data-rating-score>
              <span data-i18n="rating.prefix"></span> <span data-score-value>0</span>/5
            </div>
          </div>
          
          <div class="star-rating-hidden">
            <input type="radio" id="q9_star5" name="staffResponse" value="5">
            <input type="radio" id="q9_star4" name="staffResponse" value="4">
            <input type="radio" id="q9_star3" name="staffResponse" value="3">
            <input type="radio" id="q9_star2" name="staffResponse" value="2">
            <input type="radio" id="q9_star1" name="staffResponse" value="1">
          </div>

          <div class="low-rating-warning" data-low-rating-warning style="display: none;">
            <span data-i18n="rating.lowWarning"></span>
          </div>
        </div>
        
        <!-- Q10. 待ち時間 - 星評価に変更 -->
        <div class="question" id="question10" data-section="service">
          <h3 data-i18n="q10.title"></h3>
          
          <div class="star-rating-container">
            <div class="stars-row" data-stars-container>
              <span class="star" data-value="1">★</span>
              <span class="star" data-value="2">★</span>
              <span class="star" data-value="3">★</span>
              <span class="star" data-value="4">★</span>
              <span class="star" data-value="5">★</span>
            </div>
            
            <div class="rating-score" data-rating-score>
              <span data-i18n="rating.prefix"></span> <span data-score-value>0</span>/5
            </div>
          </div>
          
          <div class="star-rating-hidden">
            <input type="radio" id="q10_star5" name="waitTime" value="5">
            <input type="radio" id="q10_star4" name="waitTime" value="4">
            <input type="radio" id="q10_star3" name="waitTime" value="3">
            <input type="radio" id="q10_star2" name="waitTime" value="2">
            <input type="radio" id="q10_star1" name="waitTime" value="1">
          </div>

          <div class="low-rating-warning" data-low-rating-warning style="display: none;">
            <span data-i18n="rating.lowWarning"></span>
          </div>
        </div>
        
        <!-- Q11. 店内清潔感 - 星評価に変更 -->
        <div class="question" id="question11" data-section="service">
          <h3 data-i18n="q11.title"></h3>
          
          <div class="star-rating-container">
            <div class="stars-row" data-stars-container>
              <span class="star" data-value="1">★</span>
              <span class="star" data-value="2">★</span>
              <span class="star" data-value="3">★</span>
              <span class="star" data-value="4">★</span>
              <span class="star" data-value="5">★</span>
            </div>
            
            <div class="rating-score" data-rating-score>
              <span data-i18n="rating.prefix"></span> <span data-score-value>0</span>/5
            </div>
          </div>
          
          <div class="star-rating-hidden">
            <input type="radio" id="q11_star5" name="cleanliness" value="5">
            <input type="radio" id="q11_star4" name="cleanliness" value="4">
            <input type="radio" id="q11_star3" name="cleanliness" value="3">
            <input type="radio" id="q11_star2" name="cleanliness" value="2">
            <input type="radio" id="q11_star1" name="cleanliness" value="1">
          </div>

          <div class="low-rating-warning" data-low-rating-warning style="display: none;">
            <span data-i18n="rating.lowWarning"></span>
          </div>
        </div>
        
        <!-- Q12. 改善点・要望 -->
        <div class="question" id="question12" data-section="feedback">
          <h3 data-i18n="q12.title"></h3>
          <textarea name="improvement" rows="3" data-i18n-placeholder="q12.placeholder"></textarea>
        </div>
        
        <!-- Q13. その他感想 -->
        <div class="question" id="question13" data-section="feedback">
          <h3 data-i18n="q13.title"></h3>
          <textarea name="otherComments" rows="3" data-i18n-placeholder="q13.placeholder"></textarea>
        </div>
      </div>

<!-- Q14. 追加希望サービス -->
<div class="question" id="question14" data-section="feedback">
  <h3 data-i18n="q14.title"></h3>
  <p class="optional-note" data-i18n="optional.note"></p>
  <div class="collapsible-group">
    <!-- ヘアケア特化メニュー -->
    <details>
      <summary data-i18n="q14.grp.haircare"></summary>
      <div class="options">
        <input type="checkbox" id="wish-treat" name="wishServices" value="髪質改善トリートメント">
        <label for="wish-treat" data-i18n="q14.treat"></label>
        
        <input type="checkbox" id="wish-organic" name="wishServices" value="オーガニックカラー">
        <label for="wish-organic" data-i18n="q14.organicColor"></label>
        
        <input type="checkbox" id="wish-scalp" name="wishServices" value="スキャルプケア">
        <label for="wish-scalp" data-i18n="q14.scalp"></label>
      </div>
    </details>

    <!-- トレンドヘアスタイル技術 -->
    <details>
      <summary data-i18n="q14.grp.trend"></summary>
      <div class="options">
        <input type="checkbox" id="wish-inner" name="wishServices" value="インナーカラー">
        <label for="wish-inner" data-i18n="q14.innerColor"></label>
        
        <input type="checkbox" id="wish-balayage" name="wishServices" value="バレイヤージュ">
        <label for="wish-balayage" data-i18n="q14.balayage"></label>
        
        <input type="checkbox" id="wish-extension" name="wishServices" value="ヘアエクステンション">
        <label for="wish-extension" data-i18n="q14.extension"></label>
        
        <input type="checkbox" id="wish-korean" name="wishServices" value="韓国風ヘアセット">
        <label for="wish-korean" data-i18n="q14.koreanSet"></label>
        
        <input type="checkbox" id="wish-hair-arrange" name="wishServices" value="ヘアアレンジ">
        <label for="wish-hair-arrange" data-i18n="q14.hairArrange"></label>
      </div>
    </details>

    <!-- エステ・美容関連 -->
    <details>
      <summary data-i18n="q14.grp.beauty"></summary>
      <div class="options">
        <input type="checkbox" id="wish-lash" name="wishServices" value="まつげパーマ">
        <label for="wish-lash" data-i18n="q14.lashPerm"></label>
        
        <input type="checkbox" id="wish-eyebrow" name="wishServices" value="アイブロウデザイン">
        <label for="wish-eyebrow" data-i18n="q14.eyebrow"></label>
        
        <input type="checkbox" id="wish-facial" name="wishServices" value="フェイシャルエステ">
        <label for="wish-facial" data-i18n="q14.facial"></label>
        
        <input type="checkbox" id="wish-ear-jewelry" name="wishServices" value="耳ツボジュエリー">
        <label for="wish-ear-jewelry" data-i18n="q14.earJewelry"></label>
        
        <input type="checkbox" id="wish-accessory" name="wishServices" value="ヘアアクセサリー販売">
        <label for="wish-accessory" data-i18n="q14.accessory"></label>
      </div>
    </details>

    <!-- 男性向け特化メニュー -->
    <details>
      <summary data-i18n="q14.grp.men"></summary>
      <div class="options">
        <input type="checkbox" id="wish-mens-shave" name="wishServices" value="メンズヒゲケア">
        <label for="wish-mens-shave" data-i18n="q14.mensShave"></label>
        
        <input type="checkbox" id="wish-mens-scalp" name="wishServices" value="メンズスキャルプ">
        <label for="wish-mens-scalp" data-i18n="q14.mensScalp"></label>
        
        <input type="checkbox" id="wish-mens-make" name="wishServices" value="メンズメイク">
        <label for="wish-mens-make" data-i18n="q14.mensMake"></label>
        
        <input type="checkbox" id="wish-mens-facial" name="wishServices" value="男性向けフェイシャルケア">
        <label for="wish-mens-facial" data-i18n="q14.mensFacial"></label>
      </div>
    </details>

    <!-- 特別パッケージ・会員制度 -->
    <details>
      <summary data-i18n="q14.grp.package"></summary>
      <div class="options">
        <input type="checkbox" id="wish-bridal" name="wishServices" value="ブライダル総合プラン">
        <label for="wish-bridal" data-i18n="q14.bridal"></label>
        
        <input type="checkbox" id="wish-season" name="wishServices" value="季節限定ケア">
        <label for="wish-season" data-i18n="q14.season"></label>
        
        <input type="checkbox" id="wish-family" name="wishServices" value="ファミリープラン">
        <label for="wish-family" data-i18n="q14.family"></label>
        
        <input type="checkbox" id="wish-maike-lasson" name="wishServices" value="レディースメイク講座">
        <label for="wish-maike-lasson" data-i18n="q14.MaikeLasson"></label>
        
        <input type="checkbox" id="wish-hair-lesson" name="wishServices" value="ヘアケア＆ヘアアレンジ講座">
        <label for="wish-hair-lesson" data-i18n="q14.hairLesson"></label>
        
        <input type="checkbox" id="wish-mens-make-lesson" name="wishServices" value="メンズメイク講座">
        <label for="wish-mens-make-lesson" data-i18n="q14.mensMakeLesson"></label>
        
        <input type="checkbox" id="wish-mens-lesson" name="wishServices" value="メンズヘアスタイリング講座">
        <label for="wish-mens-lesson" data-i18n="q14.mensLesson"></label>
      </div>
    </details>

    <!-- デジタル活用サービス -->
    <details>
      <summary data-i18n="q14.grp.digital"></summary>
      <div class="options">
        <input type="checkbox" id="wish-ai" name="wishServices" value="AIヘアスタイルシミュレーション">
        <label for="wish-ai" data-i18n="q14.aiSim"></label>
        
        <input type="checkbox" id="wish-online" name="wishServices" value="オンラインヘア相談">
        <label for="wish-online" data-i18n="q14.onlineConsult"></label>
        
        <input type="checkbox" id="wish-app" name="wishServices" value="ヘアケアアプリ連動サービス">
        <label for="wish-app" data-i18n="q14.app"></label>
      </div>
    </details>
  </div><!-- /.collapsible-group -->
</div><!-- /#question14 -->


      <!-- グローバルバリデーションメッセージ -->
      <div class="validation-message" id="global-validation" style="text-align: center; margin-bottom: var(--spacing-md);">
        <span data-i18n="validation.global"></span>
      </div>
      
      <!-- 送信ボタン -->
      <div class="submit-container">
        <button type="button" id="submitButton" class="submit-button" data-i18n="submit"></button>
      </div>
    </form>

    <!-- 星3以下用のメッセージ -->
    <div id="thankyou" class="question feedback-card hidden" data-section="feedback">
      <h2 data-i18n="thankyou.title"></h2>
      <p data-i18n="thankyou.low"></p>
    </div>

    <!-- 星4以上用の口コミ促進メッセージ -->
    <div id="review-redirect" class="question feedback-card hidden" data-section="feedback">
      <h2 data-i18n="thankyou.high"></h2>
      <p data-i18n="thankyou.high.text1"></p>
      <p data-i18n="thankyou.high.text2"></p>
      <p data-i18n="thankyou.high.text3"></p>
      
      <div class="copy-container">
        <textarea id="comment-to-copy" readonly></textarea>
        <p class="copy-hint" data-i18n="thankyou.copy.hint"></p>
        <div>
          <button id="copy-button" class="action-button" data-i18n="thankyou.copy.button"></button>
          <button id="redirect-button" class="action-button" data-i18n="thankyou.redirect.button"></button>
        </div>
      </div>
      
      <p data-i18n="thankyou.high.text4"></p>
    </div>
  </div>
</body>
</html>